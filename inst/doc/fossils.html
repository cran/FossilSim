<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Rachel C. M. Warnock" />

<meta name="date" content="2022-07-19" />

<title>Simulating fossils</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Simulating fossils</h1>
<h4 class="author">Rachel C. M. Warnock</h4>
<h4 class="date">2022-07-19</h4>



<p>This vignette provides information about how the package stores and
outputs information about fossil sampling times via the
<code>fossils</code> object and available options for simulating fossil
recovery.</p>
<div id="contents" class="section level2">
<h2>Contents</h2>
<ul>
<li><a href="#the-fossils-object">The fossils object</a></li>
<li><a href="#constant-fossil-recovery">Constant fossil recovery</a>
<ul>
<li><a href="#simulating-fossils-for-a-tree-object">Simulating fossils
for a tree object</a></li>
<li><a href="#simulating-fossils-for-a-taxonomy-object">Simulating
fossils for a taxonomy object</a></li>
</ul></li>
<li><a href="#interval-dependent-fossil-recovery">Interval-dependent
fossil recovery</a>
<ul>
<li><a href="#simulating-fossils-for-a-fixed-number-of-intervals">Simulating
fossils for a fixed number of intervals</a></li>
<li><a href="#simulating-fossils-for-a-set-of-non-uniform-intervals">Simulating
fossils for a set of non-uniform intervals</a></li>
<li><a href="#simulating-fossils-using-per-interval-probabilities">Simulating
fossils using per-interval probabilities</a></li>
<li><a href="#incorporating-stratigraphic-age-uncertainty">Incorporating
stratigraphic age uncertainty</a></li>
</ul></li>
<li><a href="#environment-dependent-fossil-recovery">Environment-dependent
fossil recovery</a></li>
<li><a href="#lineage-dependent-fossil-recovery">Lineage-dependent
fossil recovery</a>
<ul>
<li><a href="#the-autocorrelated-fossil-recovery-model">The
autocorrelated fossil recovery model</a></li>
<li><a href="#the-independent-fossil-recovery-model">The independent
fossil recovery model</a></li>
<li><a href="#environment-and-lineage-dependent-fossil-recovery">Environment
and lineage-dependent fossil recovery</a></li>
</ul></li>
<li><a href="#extant-species-and-tip-sampling">Extant species and tip
sampling</a></li>
</ul>
<div id="the-fossils-object" class="section level3">
<h3>The fossils object</h3>
<p>The <code>fossils</code> object contains information about fossil
sampling times and their relationship to the corresponding
<code>phylo</code> and <code>taxonomy</code> objects. In some simulation
conditions we may know the age of fossils precisely. Alternatively,
there may be some uncertainty associated with specimen ages, i.e. we
only know the age to within some stratigraphic interval, which can be
incorporated into the <code>fossils</code> object.</p>
<p>The object contains a dataframe with species and age information for
each fossil with the following 4 fields:</p>
<ul>
<li><p><code>sp</code> the label of the corresponding species. This
label matches the edge labels in the corresponding <code>phylo</code>
object or the species labels in the corresponding <code>taxonomy</code>
object if taxonomic information was provided</p></li>
<li><p><code>edge</code> the label of the sampled node or tip in the
phylogeny, i.e the node at the end of the edge along which the fossil
was sampled</p></li>
<li><p><code>hmin</code> the age of the fossil or the youngest bound of
the time interval in which the fossil was sampled</p></li>
<li><p><code>hmax</code> the oldest bound of the time interval in which
the fossil was sampled. This is equal to <code>hmin</code> if exact
sampling times are known</p></li>
</ul>
<p>The object also contains a logical variable
<code>from.taxonomy</code> indicating whether the fossil record was
simulated using a <code>taxonomy</code> object, in which case
<code>from.taxonomy = TRUE</code>, or from a <code>phylo</code> object
in which case <code>from.taxonomy = FALSE</code> (the default).</p>
</div>
</div>
<div id="constant-fossil-recovery" class="section level2">
<h2>Constant fossil recovery</h2>
<p>The simplest model of fossil recovery is a Poisson sampling process,
where fossils are sampled along lineages with constant rate <span class="math inline">\(\psi\)</span> (function argument
<code>rate</code>).</p>
<p>Fossils can be simulated using a <code>phylo</code> object or an
existing <code>taxonomy</code> object generated using the function
<code>sim.taxonomy</code>.</p>
<div id="simulating-fossils-for-a-tree-object" class="section level3">
<h3>Simulating fossils for a tree object</h3>
<p>If a <code>phylo</code> rather than a <code>taxonomy</code> object is
passed to the function, it will assume that all speciation has occurred
via symmetric (i.e. bifurcating, <span class="math inline">\(\beta =
1\)</span>) speciation, i.e. every edge in the tree represents a unique
species. This applies to all functions used to simulate fossils.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the random number generator seed to generate the same results using the same code</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a tree using TreeSim conditioned on tip number</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>tips <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> TreeSim<span class="sc">::</span><span class="fu">sim.bd.taxa</span>(<span class="at">n =</span> tips, <span class="at">numbsim =</span> <span class="dv">1</span>, <span class="at">lambda =</span> lambda, <span class="at">mu =</span> mu)[[<span class="dv">1</span>]]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># t is an object of class phylo</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>t</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Phylogenetic tree with 8 tips and 7 internal nodes.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tip labels:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   t8, t4, t3, t1, t6, t2, ...</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rooted; includes branch lengths.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># use t$edge, t$edge.length, t$root.edge to see the tree attributes</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate fossils</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">=</span> <span class="dv">3</span> <span class="co"># poisson sampling rate</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.poisson</span>(<span class="at">rate =</span> rate, <span class="at">tree =</span> t)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>f</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sp edge       hmin       hmax</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   1    1 0.58684752 0.58684752</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1    1 0.17795617 0.17795617</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   1    1 0.58613520 0.58613520</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   1    1 0.57453591 0.57453591</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   2    2 0.14585530 0.14585530</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   2    2 0.70851792 0.70851792</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   2    2 0.72224865 0.72224865</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   6    6 0.82173813 0.82173813</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   6    6 0.35835122 0.35835122</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  7    7 0.04035432 0.04035432</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fossil record with 19 occurrences representing 9 species</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fossil record not simulated using taxonomy: all speciation events are assumed to be symmetric</span></span></code></pre></div>
<p>Each entry in the <code>fossils</code> dataframe corresponds to a
fossil sampling time. <code>sp</code> and <code>edge</code> are the
species and edge labels, respectively, which will be the same here since
we assume symmetric speciation.</p>
<p><code>hmin</code> and <code>hmax</code> are the youngest and oldest
sampling ages associated with each fossil, respectively. Since this
function returns exact fossil sampling times <code>hmin</code> and
<code>hmax</code> are equal.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot fossil occurrences</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot stratigraphic ranges</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">show.ranges =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="simulating-fossils-for-a-taxonomy-object" class="section level3">
<h3>Simulating fossils for a taxonomy object</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate taxonomy under mixed speciation</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fl">0.5</span> <span class="co"># probability of symmetric speciation</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>lambda.a <span class="ot">=</span> <span class="fl">1.2</span> <span class="co"># rate of anagenetic speciation</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="fu">sim.taxonomy</span>(<span class="at">tree =</span> t, <span class="at">beta =</span> beta, <span class="at">lambda.a =</span> lambda.a)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.poisson</span>(<span class="at">rate =</span> rate, <span class="at">taxonomy =</span> s)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>f</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sp edge       hmin       hmax</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   1    1 0.51041313 0.51041313</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   4    4 0.09823000 0.09823000</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   4   15 0.92636044 0.92636044</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   4    4 0.11874836 0.11874836</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   4    4 0.21412201 0.21412201</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   5    5 0.24648919 0.24648919</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   5    5 0.07274807 0.07274807</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   7    7 0.62286500 0.62286500</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   8    8 0.71570068 0.71570068</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  8    8 0.77713392 0.77713392</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fossil record with 27 occurrences representing 12 species</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fossils record simulated from or assigned to an existing taxonomy</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output and color fossils by taxonomy</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">taxonomy =</span> s, <span class="at">show.taxonomy =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that <code>sp</code> and <code>edge</code> are not all equal,
since some species are assigned to multiple edges, and some edges are
associated with multiple species.</p>
</div>
</div>
<div id="interval-dependent-fossil-recovery" class="section level2">
<h2>Interval-dependent fossil recovery</h2>
<p>Under the interval-dependent model, fossil recovery changes in a
piece-wise manner across a set of user defined intervals. Interval ages
can be specified using a fixed set of uniform length intervals, by
passing the function the maximum interval age (<code>max.age</code>) and
the number of intervals (<code>strata</code>), or a vector of
non-uniform intervals (<code>interval.ages</code>).</p>
<p>The function <code>tree.max</code> can be used to assign a maximum
age based on tree age. If the tree has a <code>root.edge</code> the
function will return the origin time, otherwise the function returns the
root age.</p>
<div id="simulating-fossils-for-a-fixed-number-of-intervals" class="section level3">
<h3>Simulating fossils for a fixed number of intervals</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define max interval age based on tree age</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>max.age <span class="ot">=</span> <span class="fu">tree.max</span>(t)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of intervals</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>strata <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector of sampling rates, where the first entry corresponds the youngest interval</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.intervals</span>(<span class="at">tree =</span> t, <span class="at">rates =</span> rates, <span class="at">max.age =</span> max.age, <span class="at">strata =</span> strata)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">strata =</span> strata)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAHgCAMAAABKCk6nAAAAaVBMVEUAAAC/v7+/v8q/v9W/ysq/yuC/1erKv7/Kv8rKv9XKyuDK4PTVv7/Vv8rVv9XV1crV4ODV6v/gyr/gysrgytXg9P/l5eXq1b/q/+rq///y8vL04Mr0////6tX/9OD/9PT//+r///T///9rHI7vAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMy0lEQVR4nO3di3JUxxVG4VEcOxdywwkijoAY3v8hw0wLoSP1WH12r9nT2VqrKo5coc752Z+RwQF8+GKlO1x7gF02gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELp7AxRO4eAIXT+DiCVw8gYsncPEELt5Fgf8DdwtH78MHAgYCrzwQMBB45YGAgcArDwQMBF55IGAg8MoDAQOBVx4IGAi88kDAQOCVBwIGAq88EDAQeOWBgIHAKw8EDAReeSBgIPDKAwEDgVceCBgIvPJAwEDglQcCBgKvPBAwEHjlgYCBwCsPBAwEvtLAw1DzBgJfaeBh5AsBBgJfaaDAc/cbit4ncN79hqL3CZx3v6HofQLn3W8oep/Aefcbit4ncN79hqL3CZx3v6HofQLn3W8oep/Aefcbit4ncN79hqL3CZx3v6HofQLn3W8oep/Aefcbit4ncN79hqL3CZx3v6GwYYf9AwXuFHQ8G7XrcDjsHihwp6Dj2aBZp59cs3egwJ2CjmdjVt3/9KmdAwXuFHQ822+CXTqBrwa8c9X3b8B+C54s6Hi2M2B7Zz34CjxZ0PFsZ7x27zr4wySmoOPZznClDBR47n5D9d8i8HDxS03fb6j+WwQeLn6p6fsN1X+LwMPFLzV9v6H6bxF4uPilpu83VP8tAg8Xv9T0/Ybqv0Xg4eKXmr7fUP23CDxc/FLT9xuq/xaBh4tfavp+Q/XfIvBw8UtN32+o/lsEHi5+qen7DdV/i8DDxS81fb+h+m+5MvDj/wEwEPhZ1wXe/FQAwEDgZ10VePuTPQADgZ91TeAnP50HMBD4WUnAQ80bCPysHOB+T34+HmAg8LOuCXy7/fmWgIHAz7oq8O3BHyZx9d9yXeBNgIHAzxJ4uPilcu7Xf4vAw8UvlXO//lsEHi5+qZz79d8i8HDxS+Xcr/8WgYfbdRzsl+1NJ/Bo+4Dz7xcekjUQMBA4MiRrIGAgcGRI1kDAQODIkKyBgIHAkSFZAwEDgSNDsgYCBgJHhmQNBAwEjgzJGggYCBwZkjUQMBA4MiRrIGAgcGRI1kDAQODIkKyBgIHAkSFZAwEDgSNDsgYCBgJHhmQNBAwEjgzJGggYCBwZkjUQMBA4MiRrIGAgcGRI1kDAQODIkKyBgIHAkSFZAwEDgSNDsgYCBgJHhmQNBAwEjgzJGggYCBwZkjUQMBA4MgQZOPBboQEGAkeGEAMPA/9uLMBA4MgQYODpV0G99IUAA4EjQ+YH3v86txe+FGAg8PMhCzVvIDDZ+KvvAV/4UoCBwGQ73j3iK/BkQUZm4ICvwJMFGfMGAgYCk9EDAQOByeiBgIHAZPRAwEBgMnogYCAwGT0QMBCYjB4IGAhMRg8EDAQmowcCBgKT0QMBA4HJ6IGAgcBk9EDAQGAyeiBgIDAZPRAwEJiMHggYCExGDwQMBCajBwIGApPRAwEDgcnogYCBwGT0QMBAYDJ6IGAgMBk9EDAQmIweCBgITEYPBAwEJqMHAgYCk9EDAQOByeiBgIHAZPRAwEBgMnogYCAwGT0QMBCYjB4IGAhMRg8EDAQmowcCBhcF3vcbjpQFHvil/GciDIBnnG3XccoCj/xmHGcCDAQm671k6LfTORNg8FqBod/H6tLNG7xa4OMfdu0b6fxfSrGVgIHAZP1XhX0FjpcI7PeiW3WB4wEGApOBA08BBgKTgQNPAQYCk4EDTwEGApOBA08BBgKTgQNPAQYCk4EDTwEGApOBA08BBgKTgQNPAQYCk4EDTwEGApOBA08BBgKTgQNPAQYCk4EDTwEGApOBA08BBgKTgQNPAQYCk4EDTwEGrxT4IDDRruMI/DzAQGAybmALMBCYjBvYAgwEJuMGtgADgcm4gS3AQGAybmALMBCYjBvYAgwEJuMGtgADgcm4gS3AQGAybmALMBCYjBvYAgwEJuMGtgADgcm4gS3AQGAybmALMBCYjBvYAgwEJuMGtgADgcm4gS3AQGAybmALMBCYjBvYAgxeLfD/R/MGrxX49Mdd+0biBrYAA4HJuIEtwEBgMm5gCzAQmIwb2AIMBCbjBrYAA4HJuIEtwEBgMm5gCzAQmIwb2AIMBCbjBrYAA4HJuIEtwEBgMm5gCzAQmIwb2AIMBCbjBrYAA4HJuIEtwEBgMm5gCzAQmIwb2AIMBCbjBrYAA4HJuIEtwEBgMm5gCzAQmIwb2AIMBCbjBrYAA4HJuIEtwEBgMm5gCzAQmIwb2AIMFgJOTWCide8nMNK69xMYad37CYy07v0ERlr3fgIjrXs/gZHWvZ/ASOveT2Ckde8nMNK69xMYad37CYy07v0ERlr3fgIjrXs/gZHWvd9e4Nz/L/N78wYCjwFnD2wBBgIPJXC3GGPG/QRGijFm3E9gpBhjxv0ERooxZtxPYKQYY8b9BEaKMWbcT2CkGGPG/QRGijFm3E9gpBhjxv0ERooxZtxPYKQYY8b9BEaKMWbcT2CkGGPG/QRGijFm3E9gpBhjxv0ERooxZtxPYKQYY8b9BEaKMWbcT2CkGGPG/QRGijFm3E9gpBhjxv0ERooxZtxPYKQYY8b9BEaKMWbcT2CkGGPG/QRGijFm3E9gpBhjxv0ERooxZtxv9y/zE7jXusCt8TcL3C3GmHe/8TcL3C3GmHe/8TcL3C3GmHe/8TcL3C3GmHe/8TcL3C3GmHe/8TcL3C3GmHe/8TdfAvj+XxzxWwEGAg91AeDjj65f+jKAgcBD8cDtn5+88IUAA4GH+gaM/iZYA80bCLwPGBt4GPkmDBgIPBQPfOun6Ln7jTT+5gsA3/qdrLn7DTT+5ksA3/rDpLn7vdz4my8C/HKAgcBDCdwtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3C9wtLJl0v/E3P/wkqdyBgIHAuxJ4U4wx7377Fwi8KcaYd7/9CwTeFGPMu9/+BQJvijHm3W//AoE3xRjz7rd/gcCbYox599u/QOBNMca8++1fIPCmGGPe/fYvEHhTjDHvfvsXCLwpxph3v/0LBN4UY8y73/4FAm+KMebdb/8CgTfFGPPut3+BwJtijHn3279A4E0xxrz77V8g8KYYY9799i8QeFOMMe9++xcIvCnGmHe//QsE3hRjzLvf/gX+Plmb6gEnDwQMBF55IGAg8MoDAQOBVx4IGAi88kDAQOCVBwIGAq88EDAQeOWBgIHAKw8EDAReeSBgIPDKAwEDgVceCBgIvPJAwEDglQcCBgKvPBAwEHjlgYCBwCsPBAwEXnkgYCDwygMBg4sCf7mxueYJLgl87esUaB7hssCv63lLDhR44QcKvNbzlhwo8MIPFHit5y05UOCFHyjwWs9bcqDACz9Q4LWet+RAgRd+4OrAtkACF0/g4glcPIGLJ3DxBC6ewMUTuHgCF0/g4glcPIGLJ3DxBC6ewMUTuHg88Oefb25+evTB3f2fxvv1b7+c/rs96f3NzVvmee2D+ed9/PaEr4/64RfgK/z0uTPxwHc/faV9+/DBpz9/aH8a7te//HACaU/6+OOHz/98RzyvffDxp+/gwef99d2nPx2f0HbNf4WfPneqy3yKvnvz8MHDh9E+/+vfDaA96fjHqWc+PO/hg0ngo2ijPXFMf4WfPXeqiwA//hz4/h9/gD5FtycdvwX/PHfD7afor59S5769fTz+feP4iI+/Pw4EvsJPnjvVJYC/fm75/sH7Hz/MzvwG3J70/uZ3f0eBZ8/4HeK/H77cvQW+wk+fO9MFgD/98d2jD44TJz9rfQN+eBLzF8yj771N7dt8Kr17A3yFO88NxwM/fMegfQD8dXjv0J709Y+z3/XYAM/ve/jO0PFRd2+Zb3hf1v1O1vvjbz3w5vh339MHxx81TP71fHQ4/qc9iflh0gn52w+TJvedfjhzfFZ71PxX+PFzZ/MfdBRP4OIJXDyBiydw8QQunsDFE7h4AhdP4OIJXDyBiydw8QQunsDFE7h4AhdP4OIJXDyBiydw8QQunsDFE7h4AhdP4OIJXDyBiydw8QQunsDFE7h4AhdP4OIJXDyBiydw8QQunsDFE7h4AhdP4OIJXDyBiydw8QQunsDFE7h4AhdP4OIJXDyBiydw8f4HZEuocuwF5zgAAAAASUVORK5CYII=" /><!-- --></p>
<p>If no maximum is provided to the plotting function and
<code>strata</code> &gt; 1, the function <code>tree.max</code> is used
to define <code>max.age</code>.</p>
</div>
<div id="simulating-fossils-for-a-set-of-non-uniform-intervals" class="section level3">
<h3>Simulating fossils for a set of non-uniform intervals</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the following will sample a random set of interval ages between 0 and max.age</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>times <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">3</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> max.age)), max.age)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector of sampling rates from youngest to oldest</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.intervals</span>(<span class="at">tree =</span> t, <span class="at">rates =</span> rates, <span class="at">interval.ages =</span> times)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output and show sampling or proxy data</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">interval.ages =</span> times, <span class="at">show.proxy =</span> <span class="cn">TRUE</span>, <span class="at">proxy =</span> rates)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="simulating-fossils-using-per-interval-probabilities" class="section level3">
<h3>Simulating fossils using per-interval probabilities</h3>
<p>Fossil recovery can also be specified using a set of per-interval
probabilities. At most one fossil per species will be sampled per
interval using this approach.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define max interval age based on tree age</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>max.age <span class="ot">=</span> <span class="fu">tree.max</span>(t)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of intervals</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>strata <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define a vector of sampling probabilities from youngest to oldest</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.intervals</span>(<span class="at">tree =</span> t, <span class="at">probabilities =</span> probabilities, <span class="at">max.age =</span> max.age, <span class="at">strata =</span> strata)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">strata =</span> strata)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="incorporating-stratigraphic-age-uncertainty" class="section level3">
<h3>Incorporating stratigraphic age uncertainty</h3>
<p>To incorporate age uncertainty into the output using the function
<code>sim.fossils.intervals</code> set
<code>use.exact.times = FALSE</code>. In this case <code>hmin</code> and
<code>hmax</code> will represent the youngest and oldest age associated
with the fossil, respectively. When we plot the output the function will
place the fossils at the mid-point of the corresponding interval. This
means in some cases fossils will not appear along their corresponding
edge.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.intervals</span>(<span class="at">tree =</span> t, <span class="at">probabilities =</span> probabilities, <span class="at">max.age =</span> max.age, <span class="at">strata =</span> strata, <span class="at">use.exact.times =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>f</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sp edge      hmin      hmax</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   1    1 0.0000000 0.5640402</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1    1 0.5640402 1.1280804</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   2    2 0.0000000 0.5640402</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   3    3 0.0000000 0.5640402</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   3    3 0.5640402 1.1280804</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   4    4 0.0000000 0.5640402</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   6    6 0.0000000 0.5640402</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   6    6 0.5640402 1.1280804</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   7    7 0.0000000 0.5640402</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  8    8 0.0000000 0.5640402</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fossil record with 12 occurrences representing 9 species</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fossil record not simulated using taxonomy: all speciation events are assumed to be symmetric</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">strata =</span> strata)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Alternatively, if you simulate fossils using a function that only
returns exact fossil sampling times, e.g. using the
<code>sim.fossils.poisson</code> function, you can later assign fossils
to different intervals using the <code>sim.interval.ages</code>
function. You can also generate output using this function that respect
the species duration times by setting
<code>use.species.ages = TRUE</code>, i.e. the function will not return
a value for <code>hmin</code> or <code>hmax</code> that are younger or
older than the true species age. To use this option you also need to
pass a <code>phylo</code> or <code>taxonomy</code> object to the
function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.poisson</span>(<span class="at">tree =</span> t, <span class="at">rate =</span> <span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># reassign fossils to intervals</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.interval.ages</span>(<span class="at">fossils =</span> f, <span class="at">tree =</span> t, <span class="at">max.age =</span> max.age, <span class="at">strata =</span> strata, <span class="at">use.species.ages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">strata =</span> strata)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="environment-dependent-fossil-recovery" class="section level2">
<h2>Environment-dependent fossil recovery</h2>
<p>The function <code>sim.fossils.environment</code> can be used to
simulate fossil recovery that reflects species environmental
preferences. The variables that control the distribution and abundance
of species also control depositional environment, meaning changes in
ecological or environmental gradient across a given area will be
reflected in the patterns of deposition. A species response curve, which
describes the abundance of a species relative to an environmental
gradient, can therefore be used to model distributions of fossil
occurrences. See the plot below for examples.</p>
<p><span class="citation">Holland (1995)</span> described a three
parameter Gaussian model for simulating environment-dependent fossil
recovery. In this model each species has three parameters, species
preferred depth (<span class="math inline">\(PD\)</span>), depth
tolerance (<span class="math inline">\(DT\)</span>) and peak abundance
(<span class="math inline">\(PA\)</span>) (function arguments
<code>PD</code>, <code>DT</code> and <code>PA</code>). The probability
of fossil recovery during a given interval of time is a function of
water depth, given by,</p>
<p><span class="math inline">\(Pr_{collection_i}(d) = PA * exp(-(d -
PD)^2/ (2*DT^2))\)</span>,</p>
<p>where <span class="math inline">\(d\)</span> is current water depth,
<span class="math inline">\(PD\)</span> and <span class="math inline">\(DT\)</span> are the mean and the standard
deviation of the distribution, respectively, and <span class="math inline">\(PA\)</span> describes the amplitude of the
distribution. Here the model is described in the context of marine taxa,
however the model and the function <code>sim.fossils.environment</code>
can be applied to any environmental or depositional context, in which
some measure of environmental gradient can be generated.</p>
<p>The following code snippet illustrate how to explore the role of the
model parameters <span class="math inline">\(PD\)</span>, <span class="math inline">\(DT\)</span> and <span class="math inline">\(PA\)</span> in determining species response
curves.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a set of colors for 4 species</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># color palette chosen using RColorBrewer</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>) <span class="co"># red, blue, purple, green</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># species response curve function</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>response.curve <span class="ot">=</span> <span class="cf">function</span>(x, pd, dt, pa) pa <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(x <span class="sc">-</span> pd)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>dt<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># define species variables # species 1</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>PA <span class="ot">=</span> <span class="dv">1</span> <span class="co"># peak abundance</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">=</span> <span class="dv">2</span> <span class="co"># preferred depth</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">=</span> <span class="dv">1</span> <span class="co"># depth tolerance</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot species resonse curve</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">response.curve</span>(x, PD, DT, PA), <span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;relative depth&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Pr(collection)&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>), <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> cols[<span class="dv">1</span>])</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># redefine depth tolerance and compare the output # species 2</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">response.curve</span>(x, PD, DT, PA), <span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> cols[<span class="dv">2</span>])</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># redefine preferred depth and compare the output # species 3</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">response.curve</span>(x, PD, DT, PA), <span class="sc">-</span><span class="dv">5</span>, <span class="dv">1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> cols[<span class="dv">3</span>])</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># redefine prferred depth and peak abundance # species 4</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">=</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>PA <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">response.curve</span>(x, PD, DT, PA), <span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="fl">2.2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> cols[<span class="dv">4</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The user is free to use a vector containing any gradient values to
simulate fossil occurrences. In the following example we will use a
vector of gradient values generated using the function
<code>sim.gradient</code>, which return values for the following simple
sine wave function, <span class="math inline">\(y =
d*sin(cycles*pi*(x-1/4))\)</span>, where <span class="math inline">\(x\)</span> is the number of intervals or strata.
The function output can be used to represent changes in relative water
depth, where the number of cycles may be equivalent to the number of
transgression/regression events.</p>
<p>Interval ages can be specified in the same way as the function
<code>sim.fossils.intervals</code> via <code>max.age</code> and
<code>strata</code> or the <code>intervals</code> vector.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the interval parameters</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>strata <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>times <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">tree.max</span>(t), <span class="at">length.out =</span> strata<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate gradient values</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">=</span> <span class="fu">sim.gradient</span>(strata, <span class="at">depth =</span> <span class="dv">6</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># wd is a vector representing relative water depth</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>wd</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] -6.0000000 -4.7348431 -1.4729129  2.4101725  5.2768425  5.9181678</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7]  4.0636894  0.4954761 -3.2816889 -5.6749035 -5.6749035 -3.2816889</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13]  0.4954761  4.0636894  5.9181678  5.2768425  2.4101725 -1.4729129</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19] -4.7348431 -6.0000000</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># define species trait values # species 1</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>PA <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.environment</span>(<span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">proxy.data =</span> wd, <span class="at">PD =</span> PD, <span class="at">DT =</span> DT, <span class="at">PA =</span> PA)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># plot output and include proxy data &amp; preferred depth</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">show.proxy =</span> <span class="cn">TRUE</span>, <span class="at">proxy.data =</span> wd, <span class="at">show.preferred.environ =</span> <span class="cn">TRUE</span>, <span class="at">preferred.environ =</span> PD, <span class="at">fossil.col =</span> cols[<span class="dv">1</span>])</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co"># redefine species trait values # species 2</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.environment</span>(<span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">proxy.data =</span> wd, <span class="at">PD =</span> PD, <span class="at">DT =</span> DT, <span class="at">PA =</span> PA)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plot output</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">show.proxy =</span> <span class="cn">TRUE</span>, <span class="at">proxy.data =</span> wd, <span class="at">show.preferred.environ =</span> <span class="cn">TRUE</span>, <span class="at">preferred.environ =</span> PD, <span class="at">fossil.col =</span> cols[<span class="dv">2</span>])</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co"># redefine species trait values # species 3</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.environment</span>(<span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">proxy.data =</span> wd, <span class="at">PD =</span> PD, <span class="at">DT =</span> DT, <span class="at">PA =</span> PA)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co"># plot output</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">show.proxy =</span> <span class="cn">TRUE</span>, <span class="at">proxy.data =</span> wd, <span class="at">show.preferred.environ =</span> <span class="cn">TRUE</span>, <span class="at">preferred.environ =</span> PD, <span class="at">fossil.col =</span> cols[<span class="dv">3</span>])</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co"># define species trait values # species 4</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">=</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>PA <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.environment</span>(<span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">proxy.data =</span> wd, <span class="at">PD =</span> PD, <span class="at">DT =</span> DT, <span class="at">PA =</span> PA)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co"># plot output</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">show.proxy =</span> <span class="cn">TRUE</span>, <span class="at">proxy.data =</span> wd, <span class="at">show.preferred.environ =</span> <span class="cn">TRUE</span>, <span class="at">preferred.environ =</span> PD, <span class="at">fossil.col =</span> cols[<span class="dv">4</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAHgCAMAAABKCk6nAAAAgVBMVEUAAAAfHx83fri/v7+/v8q/v9W/ysq/yuC/1erKv7/Kv8rKv9XKyuDK4PTVv7/Vv8rVv9XVyuDV1crV4ODV6urV6vTV6v/gyr/gysrgytXg4NXg6uDg9P/l5eXq1b/q/+rq///y8vL04Mr09P/0////6tX/9OD/9PT//+r///T///+9i84HAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQ30lEQVR4nO2dgXbbuBFFHSmprc3a2W5aJdt6talqqbL//wMrkCJFiUMKoIEBOLnvnCQO9YgZ4JokQELg3RsyrbvcCaC0ArBxAdi4AGxcADYuABsXgI0LwMYFYOMCsHEB2LgAbFwANi4AGxeAjQvAxgVg4wKwcQHYuABsXAA2LgAbF4CNC8DGBWDjArBxAdi4AGxcADYuABsXgI0rAeD/9PRnT1MseC4EYOMeABv3ANi4B8DGPQA27gGwcQ+AjXsAbNwDYOMeABv3ANi4B8DGPQA27gHwLD13/gLwHD133uV40gBwWR4AG/cA2LgHwMY9ADbuAbBxD4CNewBs3ANg4x4AZ/MsFguFWADO5VkseoRTxAJwJs9i0SecIhaAdT3Nk5tFo4CnPdMEYF3AjYMj2DhgrsHWAdOLtg5YJx8A63oADOC4+QBY1wNgAMfNB8C6HgADOG4+ANb1ABjAcfMBsK4HwACOm0/AcycAR/CoA/b3eNIA8KgHwADOlTOAnfrP+MLKAXDZgIWn9GHlALhowNI8m7ByABwFcKL5azFmygE4CmCO4HAPgP/kGmweML1o64Df6wEwgHPlDOAYHgADOFfOAI7hATCAc+UM4BgeAAM4V84AjuEBMIBz5QzgGB4AAzhXzgCO4QEwgHPlDOAYHgADOFfOAI7hAbB1wAULwLY9njQAPFcPgI17AGzcA2DjHgAb9wDYuAfAxj0ANu4BsHEPgI17AGzcA2DjHgAb9wDYuAfAxj0ANu4BsHEPgI17AGzcA2DjHgAb9wDYuAfAxj0ATuipF0jMmw+A03lOS5zmzScf4AnfwsjdWGGeZpHivPnkAxxeg5yAg38ZYywzHkUA9gMcXE4DmCPYuwbzAswpOrgGMwP8s3eywmswN8AMkwJrMDvAJXgA7OcBMIBV8/H2ANjPA2AAq+bj7QGwnwfAAFbNx9sDYD8PgAGsmo+3B8A+nrs7ANsGzBEMYM18AjwA9vEAGMCq+QR4AOzjATCAVfMJ8ADYxwNgAKvmE+ABsI8HwABWzSfAA2AfD4ABrJpPgAfAPh4AA1g1nwAPgH08d0W/+mpcAPYCrBcrsseTBoC1wcTyANjHA2AAq+YT4AGwjwfAAFbNJ8ADYB8PgAGsmk+AB8A+HgADWDWfAA+AfTwABrBqPgEeAPt4AAxg1XwCPAD28QAYwKr5BHhmBTifyoRnDXC+xgIwgFXzCfAA2McDYACr5hPgAbCPB8AAVs0nwANgHw+AAayaT4AHwD4eAANYNZ8AD4B9PNMAZ7y12hGA0wHOmvNJnjQAPKEcAIfXIFNjARjAQjkADq9BpsYCMICFcgAcXoNMjQVgAAvlADi8BpkaC8AAFsoBcHgNMjUWgAEslAPg8BpkaiwAA1goB8DhNcjUWAAGsFAOgMNrkKmxAAzgTjmLxaL6EMDhNcjUWEGAF4sTYQCH1yBTY4UAXiwawgAOr0GmxgqY47ZodPw5a84nATi2hyPYOGCuwdYB04u2DrgRgMNrkLexAj0ADq9B3sYK9AA4vAZ5GyvQ0wBO9a0jPwE4PeCc+XjSAPAED4DDa6ACJpYHwOE1UAETywPg8BqogInlAXB4DVTAxPIAOLwGKmBieQAcXgMVMLE8AA6vgQqYWB4Ah9dABUwsD4DDa6ACJpYHwOE1UAETywPg8BqogInlAXB4DVTAxPK0D3Ry5gPg9B4A+9dAFUwsD4D9a6AKJpYHwP41UAUTywNg/xqogonlAbB/DVTBxPIA2L8GqmBieQDsXwNVMLE8APavgSqYWB4A+9dAFUwsD4D9a6AKJpYHwP41UAUTywNg/xqogonlAbB/DVTBxPJk/GLSHd9Nsu7xpAHguXoAbNwDYOMeABv3ANi4B8DGPQA27gGwcQ+AjXsAbNwDYOMeABv35AOMShKAjQvAxgVg4wKwcQHYuABsXAA2LgAbF4CNC8DGBWDjSgF4iTSUC3Duev80ygd4wpZJO7HFQwA2s0UWgM1skQVgM1tkAdjMFlkANrNFFoDNbJEFYDNbZAHYzBZZADazRRYPG4wLwMYVAni7XD4kSwSlUQDg/a8vr9/WgQ8zUGYFAN4+ur9DH1ehvAoAvPm66pyiMwCevJyfmgrMMATw/cvbZt38Lwdgjy15VWCGIYDXzWnaCcCCCswwIIHdwxtH8LgKzDBwmNQewACWVGCGkxMAsKACMwRwTBWYYbmAfYYc2ZvvSkKGuQdOBQOO5NFUgTkDOKYKzBnAMVVgztfhDk+eT4wALKjAnPvhjqPdznB3UAAWVGDOYjgfxgAWVGDOA+Ec4k8/xnYEsKACc5bC7Y5012+v3+5fRnYEsKACc+6FO/ayljXZ3eghDGBBBebc70V/fPbaEcCCCsz5Otzrfz13BLCgAnPuH8H1MPj1D+n8vFV8XFhgY91UgTn3wu2W7hy9FfvQ+9Wj3qQ7r8bKeit/WvTcgI+95+XAMPj1+++FAY611zSVn6EczhFe9ze7E3Rpp+hYe01T+RmK4TbL5T+/LYUx8P7XFwC/P1b2TlZ1dt4J1+DtxakbwDPIUAh3+Ht96M6jFx1rr2kqP8PgcAB+f6zsgPer45n49u0sAM8gQyncrrrMbuV+dEcAnkGGQrjXb/VZeDv6KOkNwJNj5e5kPdWH7vijpDcAT47FEXxS+c1XfoZSOK7BiWPlBkwvOnGs7IA9BeAZZCiEa67BNwXgGWQohGt60TcF4BlkKIW7OT46CcAzyFAI5yZVVlIeB8eamzEDwLqzUErpZMWqZPmA05Xz3sLdTI9k62TNorESxVIGXJ2kpftY24cj41Sr7MyisRLF0gW8q+5xbAfudGwfE026m0VjJYqlCrg5RjfivejDbz8AHD2WKuDDl/rQFUdLzYdOAJ5HzkNHsPQ0af9L57wN4HnkLDxNcoSlp0n7z92DGsDzyHnwRkf/Xscm5bTZWTRWoliljIMvBeB55Azg/LEAnKEczVgAzlCOZiwAZyhHM9bsAH/4EP7v3cT9UpUzh3+9NDJMGp/aMQz4wymBoH/vJu6XqpwZ/OungWmzu+X68DQ6O4tT9Dxy7t+qrB/5bu9fxue+A3geOQ9Nutt9+qG6ENosGitRLOUjuP3qyhbAOrG0HzacrsHNyXpApQJONqUtYcmRyvEsvOpHHw/ejepqs+kqWT6G2Y2Dp6j85is/w3cXvuuOjQEcTbqA64XupInvhy/P+8+lz8lKV3L5GfoVPnzpdW8A//4M4OhSHgcP3r9K+vbR8puv/Ay9Ch/5diGAEynLrUpB9Sm6+R+AoynHrEpJdSer+R+AoynPrEqhr8UwKY2KGQdfCMDRBOAiSi4/w7iFAzia9AAfB8HZlnCIWlqKksvPMG7hAI4mABdRcvkZxi0cwNGkeQ0e/GphTwCOJo7gIkouP8O4hQM4mnLMybq1HPh7ASuu9jYDwClbo/+wYXQZpbPeCfg9O+cJNccJuUJR48sodQTghEoIeHQZpa4AnFAKR7DwxaSYa1UCWCvWwAN/aRmleq3KOJPuAKwVa/CBv3yvI9ZalQDWihVW1OG3SFN2AKwVK6ioeGtVAlgrVq+o5hx9eX7euP5VxLUqAawVq9+LHhwAx1yrEsBasfqdrMGJ7zHXqgSwVqz+EazyYiwAa8XqFXVxoR0RgBMqKeCVxgN/AGvF6p+iR1fmOAvACZWnk3UpACcUnawMoYwAppOVuhzlWIMPG+hkJSpHOVamSXeagCfNeFJ+R+h19AKKmg3gacGzJpjhYUNfAE6olIA39y/bh7f96tZoCcAJlbST9fi2u38RX213IQAnVOIbHe654OWzwUbb8yAZwAmV+EaHm7ghAt6vAKyilNdgtwz45lE8Rb9+//3xbXaT7qYFtwv4bfPgetJSJ3r7uAWwivKMg/e/vnAN1pE+YDfpbjvPKTvTglsFXHWjdsvlwJcLOYJ1lAxwdX/DfXll4EYHgHWUDPDGTeeolgTf3JrYAeCESgW4Wg28nrRj5+uj04JbBbxu1nwHcE4lBVxffqPei877cLWfTiRPOkVssP41uFqe4/bkyiDA4XmlVPmA+4oEePfx+fDkjt0brz17A7CyIgF2Q+Aj3/0q7jJKhbXWzwzYXwBWFYADBGAfAVhVAA4QgH0EYFUBOEAA9tGcAfsod5JXUgG8nbqUYWmtNUNpAHYvp5y2lCGA3y0NwPXTfg/AxZ/vZqjJF5GAtt98XS0913dAxSgE8P1L5wXRaB4KmFXp4G49F3hApSjgCL58xTuahwKHSRzAc1OKDu4SaSgX4Nz1/mmUD/CELZN2YouHAGxmiywAm9kiC8BmtsgCsJktsgBsZossAJvZIgvAZrbIArCZLbJ4Fm9cADYuABsXgI0LwMYFYOMCsHEB2LhiAX79dvpey+mHi6+5XHvcShHraqqmOIeveZG8VMaFYVO9WkK2dTzrxjnkqX8YSmfXbL9p2A5W/eypZ6aK+TSeUzsNhbsub1yxAG8fjnmt2x/qr7kMeQ5fnveff+wezi3c1eGprrtYRtfw+v150NZ46iC1c8hT/zCYTpWsK+r+RSynNdSZiPm0nno50PFy6nYayue6vBuKeYpuJ01XC0uPeFwbVFWUavD6x1+/tYClhjgb2mbt2VpPHURsjNbT/iA2aFu+S12q14VhIJ/zxmpVdXk9/e6OVVnDgIfapq+IgLsnvKGvudSeZob1dvwUvV8NLHp7Muz+VgWRbW02LsjJOZbx21A67XRwdwRLb3ZsDadKS/mc55RXv/xiPt1551VCA81z7R1XPMDuTQ/tDwNfczl5zumJSTb87gdO0S2Y/728bdcDts5v/zFI5Rz2tBdsIVwn2eXH30cBV5UW82k9p1XVpXw60Jq2HGSYAXD7UsvqB/lrLo3nfIIRT+Wn5naf7cReVgdefTUQbBeegVA9wKNnYCepUVtDXWkxn/Np3E14lfM5B2rbcvBKp3+Kbq8qpw6J9BvWetpO1q0j2L0eZMTguqzrAVvHs1nXziFP/cNQOudO1oN87ewa6iO4n0+3U+RO0VI+587acBNK5Y0rFuBN9Zvprr71r6j0NZfWcx4mDfJzfzZjw6SToR5yDFxfLzxCqMbTDpPEdKpkT0UND5OcYTucT+tph0n9WI3n1IRD+Zy9PuJGh3EB2LgAbFwANi4AGxeAjQvAxmUDcPNe+uWnv57GhofC+74ir0uxK20RExuAndr7e2OeHuD6JULRdBj9/cohAEclAuB0qgFXr6hf/eN4yn7cr+rbedtlexber76umnv91Vbn+VTdOnVbD1/+dZoi0u7wy79X0kduv27hhycXcu02336fiapsAv74fGx5x8P9Of6neTd99Un1n2Zrdci513EentyLsR2dyx3c0+Tq4+5H7Us8z8W4kO6lRBzBqdQF/PjW/LW+eFNfze2Ivd3q/PVj/OqdUY9Xr/Y77XD/cvnRrp3r0xbTRANwKnUBN2/oO/61q6ZXnC6+9T/HTe3W1t/ikXe4/Kid8dUtxsUGcDoNAT4NoNZnz/HvdusZcINH2KEF3H7kJj5WJ+9OMQBOq9EjuPFcHsFd/9URfFHo5RHcaHNVDIDTagDwRZN3LqnN7LbLa/D6aqRT77A57XCJr8sTwOk1ALh+m+qmPtSqXrTr/bZbr3rR1chH2uHyo+rI3dUd53MxFeDSlmu1D7gaqn5qJuJ+PQ2Om601uGYc/NT96GKHq4/cDh+fr4pxf20YB89Kws3rmQnAowKwcQEYFS4AGxeAjQvAxgVg4wKwcQHYuABsXAA2LgAb1/8BnsEh41EVl2gAAAAASUVORK5CYII=" /><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
<div id="lineage-dependent-fossil-recovery" class="section level2">
<h2>Lineage-dependent fossil recovery</h2>
<p>Variation in fossil recovery parameters across different lineages or
species can be generated using the function
<code>sim.trait.values</code>. The function output is a vector of
simulated trait values that can be used to specify the <code>rate</code>
parameter in <code>sim.fossils.poisson</code> or the <code>PD</code>,
<code>DT</code> and <code>PA</code> parameters in
<code>sim.fossils.environment</code>.</p>
<p>Trait values can be simulated for a given <code>phylo</code> or
<code>taxonomy</code> object. If the function is provided with a
<code>phylo</code> object, trait values are simulated assuming
bifurcating speciation and simulated trait values are output for each
edge in the order in which they appear in the <code>phylo</code> object
dataframe. If the tree also has a root edge
(<code>tree$root.edge</code>), the first entry in the vector will
correspond to the first entry in the vector. If the function is provided
with a <code>taxonomy</code> object, simulated trait values are output
for each species in the order in which they appear in the
<code>taxonomy</code> object dataframe.</p>
<div id="the-autocorrelated-fossil-recovery-model" class="section level3">
<h3>The autocorrelated fossil recovery model</h3>
<p>Under the <code>autocorrelated</code> model, traits evolve along
lineages according to a Brownian motion process, where the strength of
the relationship between ancestor and descendant values is determined by
the parameter <span class="math inline">\(\nu\)</span> (function
argument <code>v</code>). New trait values are drawn from a lognormal
distribution, where the mean is equal to the value of the ancestor and
the variance is a function of <span class="math inline">\(\nu\)</span>
and the species or edge duration. If <span class="math inline">\(\nu\)</span> is small values will be more similar
between ancestor and descendants, and if <span class="math inline">\(\nu\)</span> is zero all trait values will be
equal. This is model is described in <span class="citation">Heath <em>et
al.</em> (2014)</span> and is equivalent to the autocorrelated relaxed
clock model described in <span class="citation">Kishino <em>et al.</em>
(2001)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the initial rate at the root or origin</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">=</span> <span class="dv">1</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate rates under the autocorrelated trait values model (the default option)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">=</span> <span class="fu">sim.trait.values</span>(<span class="at">init =</span> rate, <span class="at">tree =</span> t, <span class="at">v =</span> <span class="fl">0.01</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># simulated rates</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>rates</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 0.9475371 0.8816897 0.8299168 0.8388761 0.8277377 0.8619949 0.7568962</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8] 0.8853375 0.6971045 0.8407235 0.9940334 0.9321089 0.8348147 0.8843375</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15] 0.8239667</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.poisson</span>(<span class="at">tree =</span> t, <span class="at">rate =</span> rates)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="the-independent-fossil-recovery-model" class="section level3">
<h3>The independent fossil recovery model</h3>
<p>Under the <code>independent</code> model a new trait value is drawn
for each species from any valid user-specified distribution
<code>dist</code>. To be valid the function just has to return a single
value.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the initial rate at the root or origin</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the distribution used to sample new rates</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># in this case an exponential with mean = 1</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">=</span> <span class="cf">function</span>() { <span class="fu">rexp</span>(<span class="dv">1</span>) }</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate trait values under the independent trait values model</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">=</span> <span class="fu">sim.trait.values</span>(<span class="at">init =</span> rate, <span class="at">tree =</span> t, <span class="at">model =</span> <span class="st">&quot;independent&quot;</span>, <span class="at">dist =</span> dist)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.poisson</span>(<span class="at">tree =</span> t, <span class="at">rate =</span> rates)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The parameter <code>change.pr</code> is the probability that changes
in trait values are coincident with speciation events. At each
speciation event change occurs with probability <code>change.pr</code>
and new values are drawn from any valid user-specified distribution
<code>dist</code>. If <code>change.pr = 1</code> a change will occur at
every speciation event and the model will be the same as above.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the initial value at the root or origin</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the distribution used to sample new rates</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># in this case an exponential with a mean ~ 3</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">=</span> <span class="cf">function</span>() { <span class="fu">rexp</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) }</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># define the probability of the trait value changing at each speciation event</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>change.pr <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate trait values under the independent trait values model</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">=</span> <span class="fu">sim.trait.values</span>(<span class="at">init =</span> rate, <span class="at">tree =</span> t, <span class="at">model =</span> <span class="st">&quot;independent&quot;</span>, <span class="at">dist =</span> dist, <span class="at">change.pr =</span> change.pr)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.poisson</span>(<span class="at">tree =</span> t, <span class="at">rate =</span> rates)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="environment-and-lineage-dependent-fossil-recovery" class="section level3">
<h3>Environment and lineage-dependent fossil recovery</h3>
<p>Lineage specific values generated using <code>sim.trait.values</code>
can also be passed to the the function
<code>sim.fossils.environment</code> to define the <code>PD</code>,
<code>DT</code>, and <code>PA</code> parameters.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define constant values for preferred depth and depth tolerance</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>PD <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate lineage variable peak abundance values</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define the distribution used to sample new PA values</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># in this case a uniform in the interval 0, 1</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">=</span> <span class="cf">function</span>() { <span class="fu">runif</span>(<span class="dv">1</span>) }</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate trait values under the independent model</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>PA <span class="ot">=</span> <span class="fu">sim.trait.values</span>(<span class="at">init =</span> <span class="fl">0.1</span>, <span class="at">tree =</span> t, <span class="at">model =</span> <span class="st">&quot;independent&quot;</span>, <span class="at">dist =</span> dist)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.environment</span>(<span class="at">tree =</span> t, <span class="at">interval.ages =</span> times, <span class="at">proxy.data =</span> wd, <span class="at">PD =</span> PD, <span class="at">DT =</span> DT, <span class="at">PA =</span> PA)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">tree =</span> t, <span class="at">show.strata =</span> <span class="cn">TRUE</span>, <span class="at">interval.ages =</span> times)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="extant-species-and-tip-sampling" class="section level2">
<h2>Extant species and tip sampling</h2>
<p>The functions <code>sim.extant.samples</code> and
<code>sim.tip.samples</code> can be used to simulate incomplete extant
species and tip sampling, respectively. The parameter <code>rho</code>
is the probability that an extant species or a tip will be sampled.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate fossils</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">sim.fossils.poisson</span>(<span class="at">tree =</span> t, <span class="at">rate =</span> rates)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate extant species sampling</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="fu">sim.extant.samples</span>(<span class="at">fossils =</span> f, <span class="at">tree =</span> t, <span class="at">rho =</span> <span class="fl">0.5</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f2, <span class="at">tree =</span> t, <span class="at">extant.col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for tip sampling only, create a fossil object with no fossils</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">fossils</span>()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate tip sampling</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="fu">sim.tip.samples</span>(<span class="at">fossils =</span> f, <span class="at">tree =</span> t, <span class="at">rho =</span> <span class="fl">0.75</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f2, <span class="at">tree =</span> t)  </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="see-also" class="section level2">
<h2>See also</h2>
<p>See the <code>paleotree</code> vignette to see how
<code>FossilSim</code> objects can be converted into
<code>paleotree</code> objects.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Heath2014" class="csl-entry">
Heath, T.A., Huelsenbeck, J.P. &amp; Stadler, T. (2014). <a href="https://doi.org/10.1073/pnas.1319091111"><span class="nocase">The
fossilized birth-death process for coherent calibration of
divergence-time estimates</span></a>. <em>Proceedings of the National
Academy of Sciences</em>, <strong>111</strong>, E2957–E2966.
</div>
<div id="ref-Holland1995" class="csl-entry">
Holland, S.M. (1995). <a href="https://doi.org/10.1017/S0094837300013099">The stratigraphic
distribution of fossils</a>. <em>Paleobiology</em>, <strong>21</strong>,
92–109.
</div>
<div id="ref-Kishino2001" class="csl-entry">
Kishino, H., Thorne, J.L. &amp; Bruno, W.J. (2001). Performance of a
divergence time estimation method under a probabilistic model of rate
evolution. <em>Molecular Biology and Evolution</em>,
<strong>18</strong>, 352–361.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
